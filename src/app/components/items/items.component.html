<button pButton type="button" icon="pi pi-arrow-left" label="Volver"
        (click)="backAdmin()"
        class="ui-button-secondary ui-button-rounded mb-3"></button>
<!--Table-->
<p-card>
    <p-table [columns]="cols" [value]="items" selectionMode="single" [(selection)]="itemSelected"
             (onRowSelect)="onRowSelect($event)" [paginator]="true" [rows]="10">
        <ng-template pTemplate="caption">
            Items - {{project.name}}
        </ng-template>
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                    {{col.header}}
                    <p-sortIcon [field]="col.field"></p-sortIcon>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
                <td *ngFor="let col of columns" class="text-center">
                    <ng-container *ngIf="col.type==='select'">
                        {{rowData[col.field][col.label]}}
                        <i *ngIf="col.field==='icon'" class="{{rowData[col.field].code}}"></i>
                    </ng-container>
                    <ng-container *ngIf="col.type==='text'">
                        {{rowData[col.field]}}
                    </ng-container>
                    <ng-container *ngIf="col.type==='text-area'">
                        {{rowData[col.field]}}
                    </ng-container>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="summary" let-rowData>
            <div style="text-align:left">
                <button type="button" pButton icon="pi pi-plus" (click)="showDialogToAdd()" label="Crear"></button>
            </div>
        </ng-template>
    </p-table>
</p-card>
<!--Form-->
<form ngNativeValidate (ngSubmit)="save()">
    <p-dialog header="Proyecto {{item?item.label:''}}" [(visible)]="displayDialog" [responsive]="true"
              showEffect="pide"
              [resizable]="true"
              [draggable]="true"
              [modal]="true" [style]="{maxWidth: '500px'}">
        <div class="ui-g ui-fluid" *ngIf="item">
            <ng-container *ngFor="let c of cols">
                <div *ngIf="c.type === 'text'" class="ui-g-12">
                    <div class="ui-g-4">
                        <label>{{c.header}}</label>
                    </div>
                    <div class="ui-g-8">
                        <input pInputText [(ngModel)]="item[c.field]" [name]="c.field" [required]="c.required"/>
                    </div>
                </div>
                <div *ngIf="c.type === 'text-area'" class="ui-g-12">
                    <div class="ui-g-4">
                        <label>{{c.header}}</label>
                    </div>
                    <div class="ui-g-8">
                    <textarea [(ngModel)]="item[c.field]" [rows]="5" [cols]="30" pInputTextarea
                              autoResize="autoResize" [name]="c.field" [required]="c.required"></textarea>
                    </div>
                </div>
                <div *ngIf="c.type === 'select'" class="ui-g-12">
                    <div class="ui-g-4">
                        <label>{{c.header}}</label>
                    </div>
                    <div class="ui-g-8">
                        <p-dropdown [options]="c.options" [(ngModel)]="item[c.field]" placeholder="Seleccionar"
                                    optionLabel="{{c.label}}" [showClear]="true" [name]="c.field" [filter]="true">
                            <ng-template let-icon pTemplate="selectedItem">
                                <span>{{icon.value.name}}</span>
                                <i class="{{icon.value.code}}"></i>
                            </ng-template>
                            <ng-template let-icon pTemplate="item">
                                <span>{{icon.value.name}}</span>
                                <i class="{{icon.value.code}}"></i>
                            </ng-template>
                        </p-dropdown>
                        <input type="text" style="height: 0; position: relative; top: -30px;z-index: -1"
                               [required]="c.required"
                               [(ngModel)]="item[c.field]"
                               [name]="c.field">
                    </div>
                </div>
            </ng-container>
        </div>

        <p-footer>
            <div class="ui-dialog-buttonpane ui-helper-clearfix">
                <button *ngIf="itemSelected" type="button" pButton icon="pi pi-trash" (click)="openToast()"
                        label="Eliminar"></button>
                <button type="submit" pButton icon="pi pi-check" label="Guardar"></button>
            </div>
        </p-footer>
    </p-dialog>
</form>
<!--Confirm dialog delete-->
<p-toast position="center" key="c" [modal]="true" [baseZIndex]="5000">
    <ng-template let-message pTemplate="message">
        <div style="text-align: center">
            <i class="pi pi-exclamation-triangle" style="font-size: 3em"></i>
            <h3>{{message.summary}}</h3>
            <p>{{message.detail}}</p>
        </div>
        <div class="ui-g ui-fluid">
            <div class="ui-g-6">
                <button type="button" pButton (click)="delete()" label="Si" class="ui-button-success"></button>
            </div>
            <div class="ui-g-6">
                <button type="button" pButton (click)="closeToast()" label="No" class="ui-button-secondary"></button>
            </div>
        </div>
    </ng-template>
</p-toast>
